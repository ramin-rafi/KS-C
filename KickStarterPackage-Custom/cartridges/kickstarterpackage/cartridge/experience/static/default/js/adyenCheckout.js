/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./cartridges/kickstarterpackage/cartridge/client/default/js/adyenCheckout.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./cartridges/kickstarterpackage/cartridge/client/default/js/adyenCheckout.js":
/*!************************************************************************************!*\
  !*** ./cartridges/kickstarterpackage/cartridge/client/default/js/adyenCheckout.js ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\n\r\n__webpack_require__(!(function webpackMissingModule() { var e = new Error(\"Cannot find module 'imask/dist/imask.js'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()));\r\n\r\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\r\n\r\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\r\n\r\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nvar maskedCardNumber;\r\nvar MASKED_CC_PREFIX = '************';\r\nvar selectedMethod;\r\nvar componentsObj = {};\r\nvar checkoutConfiguration = window.Configuration;\r\nvar formErrorsExist;\r\nvar isValid = false;\r\nvar checkout;\r\nvar navItemSelect = true;\r\n$('#dwfrm_billing').submit(function (e) {\r\n  e.preventDefault();\r\n  var form = $(this);\r\n  var url = form.attr('action');\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: url,\r\n    data: form.serialize(),\r\n    async: false,\r\n    success: function success(data) {\r\n      formErrorsExist = 'fieldErrors' in data;\r\n    }\r\n  });\r\n});\r\n\r\ncheckoutConfiguration.onChange = function (state) {\r\n  var type = state.data.paymentMethod.type;\r\n  isValid = state.isValid;\r\n\r\n  if (!componentsObj[type]) {\r\n    componentsObj[type] = {};\r\n  }\r\n\r\n  componentsObj[type].isValid = isValid;\r\n  componentsObj[type].stateData = state.data;\r\n};\r\n\r\ncheckoutConfiguration.showPayButton = false;\r\ncheckoutConfiguration.paymentMethodsConfiguration = {\r\n  card: {\r\n    enableStoreDetails: showStoreDetails,\r\n    onBrand: function onBrand(brandObject) {\r\n      document.querySelector('#cardType').value = brandObject.brand;\r\n      $('.credit-cards-list li').removeClass('active');\r\n      $('.credit-cards-list li.' + brandObject.brand).addClass('active');\r\n    },\r\n    onFieldValid: function onFieldValid(data) {\r\n      if (data.endDigits) {\r\n        maskedCardNumber = MASKED_CC_PREFIX + data.endDigits;\r\n        document.querySelector('#cardNumber').value = maskedCardNumber;\r\n      }\r\n    },\r\n    onChange: function onChange(state) {\r\n      isValid = state.isValid;\r\n      var componentName = state.data.paymentMethod.storedPaymentMethodId ? \"storedCard\".concat(state.data.paymentMethod.storedPaymentMethodId) : state.data.paymentMethod.type;\r\n\r\n      if (componentName === selectedMethod) {\r\n        componentsObj[selectedMethod].isValid = isValid;\r\n        componentsObj[selectedMethod].stateData = state.data;\r\n      }\r\n    }\r\n  },\r\n  boletobancario: {\r\n    personalDetailsRequired: true,\r\n    // turn personalDetails section on/off\r\n    billingAddressRequired: false,\r\n    // turn billingAddress section on/off\r\n    showEmailAddress: false,\r\n    // allow shopper to specify their email address\r\n    // Optionally prefill some fields, here all fields are filled:\r\n    data: {\r\n      // firstName: document.getElementById('shippingFirstNamedefault').value,\r\n      // lastName: document.getElementById('shippingLastNamedefault').value\r\n    }\r\n  },\r\n  paywithgoogle: {\r\n    environment: window.Configuration.environment,\r\n    onSubmit: () => {\r\n      assignPaymentMethodValue();\r\n      document.querySelector('button[value=\"submit-payment\"]').disabled = false;\r\n      document.querySelector('button[value=\"submit-payment\"]').click();\r\n    },\r\n    configuration: {\r\n      gatewayMerchantId: window.merchantAccount\r\n    },\r\n    showPayButton: true,\r\n    buttonColor: 'white'\r\n  },\r\n  paypal: {\r\n    environment: window.Configuration.environment,\r\n    intent: 'capture',\r\n    onSubmit: (state, component) => {\r\n      assignPaymentMethodValue();\r\n      document.querySelector('#adyenStateData').value = JSON.stringify(componentsObj[selectedMethod].stateData);\r\n      paymentFromComponent(state.data, component);\r\n    },\r\n    onCancel: (data, component) => {\r\n      paymentFromComponent({\r\n        cancelTransaction: true\r\n      }, component);\r\n    },\r\n    onError: (error, component) => {\r\n      if (component) {\r\n        component.setStatus('ready');\r\n      }\r\n\r\n      document.querySelector('#showConfirmationForm').submit();\r\n    },\r\n    onAdditionalDetails: state => {\r\n      document.querySelector('#additionalDetailsHidden').value = JSON.stringify(state.data);\r\n      document.querySelector('#showConfirmationForm').submit();\r\n    },\r\n    onClick: (data, actions) => {\r\n      $('#dwfrm_billing').trigger('submit');\r\n\r\n      if (formErrorsExist) {\r\n        return actions.reject();\r\n      }\r\n    }\r\n  },\r\n  afterpay_default: {\r\n    visibility: {\r\n      personalDetails: 'editable',\r\n      billingAddress: 'hidden',\r\n      deliveryAddress: 'hidden'\r\n    },\r\n    data: {\r\n      personalDetails: {\r\n        // firstName: document.querySelector('#shippingFirstNamedefault').value,\r\n        // lastName: document.querySelector('#shippingLastNamedefault').value,\r\n        // telephoneNumber: document.querySelector('#shippingPhoneNumberdefault').value,\r\n        // shopperEmail: document.querySelector('#email').value\r\n      }\r\n    }\r\n  },\r\n  facilypay_3x: {\r\n    visibility: {\r\n      personalDetails: 'editable',\r\n      billingAddress: 'hidden',\r\n      deliveryAddress: 'hidden'\r\n    },\r\n    data: {\r\n      personalDetails: {\r\n        // firstName: document.querySelector('#shippingFirstNamedefault').value,\r\n        // lastName: document.querySelector('#shippingLastNamedefault').value,\r\n        // telephoneNumber: document.querySelector('#shippingPhoneNumberdefault').value,\r\n        // shopperEmail: document.querySelector('#email').value\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nif (window.installments) {\r\n  try {\r\n    var installments = JSON.parse(window.installments);\r\n    checkoutConfiguration.paymentMethodsConfiguration.card.installments = installments;\r\n  } catch (e) {} // eslint-disable-line no-empty\r\n\r\n}\r\n\r\nif (window.paypalMerchantID !== 'null') {\r\n  checkoutConfiguration.paymentMethodsConfiguration.paypal.merchantId = window.paypalMerchantID;\r\n}\r\n\r\nif (window.googleMerchantID !== 'null' && window.Configuration.environment === 'LIVE') {\r\n  checkoutConfiguration.paymentMethodsConfiguration.paywithgoogle.merchantIdentifier = window.googleMerchantID;\r\n}\r\n/**\r\n * Changes the \"display\" attribute of the selected method from hidden to visible\r\n */\r\n\r\n\r\nfunction displaySelectedMethod(type) {\r\n  $('li.paymentMethod').hide();\r\n  $('li.paymentMethod.' +type).show();\r\n  $('li.paymentMethod.' +type).addClass('visible');\r\n  selectedMethod = type;\r\n  resetPaymentMethod();\r\n\r\n  if (['paypal', 'paywithgoogle'].indexOf(type) > -1) {\r\n    document.querySelector('button[value=\"submit-payment\"]').disabled = true;\r\n  } else {\r\n    document.querySelector('button[value=\"submit-payment\"]').disabled = false;\r\n  }\r\n\r\n  document.querySelector(\"#component_\".concat(type)).setAttribute('style', 'display:flex');\r\n  document.querySelector(\"#component_\".concat(type)).setAttribute('style', 'flex-wrap:wrap');\r\n}\r\n/**\r\n * To avoid re-rendering components twice, unmounts existing components from payment methods list\r\n */\r\n\r\n\r\nfunction unmountComponents() {\r\n  var promises = Object.entries(componentsObj).map(function (_ref) {\r\n    var [key, val] = _ref;\r\n    delete componentsObj[key];\r\n    return resolveUnmount(key, val);\r\n  });\r\n  return Promise.all(promises);\r\n}\r\n\r\nfunction resolveUnmount(key, val) {\r\n  try {\r\n    return Promise.resolve(val.node.unmount(\"component_\".concat(key)));\r\n  } catch (e) {\r\n    // try/catch block for val.unmount\r\n    return Promise.resolve(false);\r\n  }\r\n}\r\n/**\r\n * checks if payment method is blocked and returns a boolean accordingly\r\n */\r\n\r\n\r\nfunction isMethodTypeBlocked(methodType) {\r\n  var blockedMethods = ['directEbanking', 'klarna', 'paysafecard', 'giropay', 'klarna_account', 'klarna_paynow', 'bcmc_mobile_QR', 'applepay', 'cup', 'wechatpay', 'wechatpay_pos', 'wechatpaySdk', 'wechatpayQr'];\r\n  return blockedMethods.includes(methodType);\r\n}\r\n/**\r\n * Calls getPaymenMethods and then renders the retrieved payment methods (including card component)\r\n */\r\n\r\n\r\nfunction renderGenericComponent() {\r\n  return _renderGenericComponent.apply(this, arguments);\r\n}\r\n\r\nfunction _renderGenericComponent() {\r\n  _renderGenericComponent = _asyncToGenerator(function* () {\r\n    if (Object.keys(componentsObj).length !== 0) {\r\n      yield unmountComponents();\r\n    }\r\n\r\n    getPaymentMethods(function (data) {\r\n      var paymentMethod;\r\n      var i;\r\n      checkoutConfiguration.paymentMethodsResponse = data.AdyenPaymentMethods;\r\n\r\n      if (data.amount) {\r\n        checkoutConfiguration.amount = data.amount;\r\n      }\r\n\r\n      if (data.countryCode) {\r\n        checkoutConfiguration.countryCode = data.countryCode;\r\n      }\r\n\r\n      checkout = new AdyenCheckout(checkoutConfiguration);\r\n      document.querySelector('#paymentMethodsList').innerHTML = '';\r\n\r\n      if (data.AdyenPaymentMethods.storedPaymentMethods) {\r\n        for (i = 0; i < checkout.paymentMethodsResponse.storedPaymentMethods.length; i++) {\r\n          paymentMethod = checkout.paymentMethodsResponse.storedPaymentMethods[i];\r\n\r\n          if (paymentMethod.supportedShopperInteractions.includes('Ecommerce')) {\r\n            renderPaymentMethod(paymentMethod, true, data.ImagePath);\r\n          }\r\n        }\r\n      }\r\n\r\n      data.AdyenPaymentMethods.paymentMethods.forEach((pm, i) => {\r\n        !isMethodTypeBlocked(pm.type) && renderPaymentMethod(pm, false, data.ImagePath, data.AdyenDescriptions[i].description);\r\n      });\r\n      var overwriteMask = IMask(\r\n        $('#dateOfBirthInput')[0],\r\n        {\r\n          mask: Date,\r\n          lazy: false,\r\n          overwrite: true,\r\n          autofix: true,\r\n          blocks: {\r\n            Y: {mask: IMask.MaskedRange, placeholderChar: 'J', from: 1900, to: 2099},\r\n            m: {mask: IMask.MaskedRange, placeholderChar: 'M', from: 1, to: 12, maxLength: 2},\r\n            d: {mask: IMask.MaskedRange, placeholderChar: 'T', from: 1, to: 31, maxLength: 2}\r\n          }\r\n        }\r\n      );\r\n      //Focus rate pay date of birth field on load\r\n        $(\"#dateOfBirthInput\").get(0).setSelectionRange(0,0);\r\n        $(\"#dateOfBirthInput\").focus();\r\n      if (data.AdyenConnectedTerminals && data.AdyenConnectedTerminals.uniqueTerminalIds && data.AdyenConnectedTerminals.uniqueTerminalIds.length > 0) {\r\n        var posTerminals = document.querySelector('#adyenPosTerminals');\r\n\r\n        while (posTerminals.firstChild) {\r\n          posTerminals.removeChild(posTerminals.firstChild);\r\n        }\r\n\r\n        addPosTerminals(data.AdyenConnectedTerminals.uniqueTerminalIds);\r\n      }\r\n\r\n      var selectedAdyenMethod = $('#adyen-component-content').data('adyen-method');\r\n      var optionToSelect = document.querySelector('input[type=radio][name=brandCode]');\r\n      if (!selectedAdyenMethod || (selectedAdyenMethod && !navItemSelect)) {\r\n          selectedAdyenMethod = $(\".nav-item.selected\").data('adyen-method');\r\n      }\r\n      if (selectedAdyenMethod) {\r\n        if (selectedAdyenMethod == 'scheme' && $('input[name$=\"useNewCard\"]').length > 0 && ( $('input[name$=\"useNewCard\"]').val() == false || $('input[name$=\"useNewCard\"]').val() == 'false') && data.AdyenPaymentMethods.storedPaymentMethods && data.AdyenPaymentMethods.storedPaymentMethods.length > 0) {\r\n          optionToSelect = document.querySelector('input[type=radio][name=brandCode]');\r\n          // ECOM-664\r\n          // $('li.paymentMethod').hide();\r\n          // $('#paymentMethodsList li.stored').show();\r\n          // $('#paymentMethodsList li.stored label').show();\r\n          // $('#paymentMethodsList li.stored input').show();\r\n          // $('.another-card').show();\r\n        } else {\r\n          optionToSelect = document.querySelector('input[type=radio][name=brandCode][value='+selectedAdyenMethod+']');\r\n          // ECOM-664\r\n          // optionToSelect.checked = true;\r\n          // displaySelectedMethod(optionToSelect.value);\r\n        }\r\n      }\r\n      optionToSelect.checked = true;\r\n\r\n      displaySelectedMethod(optionToSelect.value);\r\n      navItemSelect = false;\r\n    });\r\n  });\r\n  return _renderGenericComponent.apply(this, arguments);\r\n}\r\n\r\nfunction renderPaymentMethod(paymentMethod, storedPaymentMethodBool, path) {\r\n  var description = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\r\n  var node;\r\n  var paymentMethodsUI = document.querySelector('#paymentMethodsList');\r\n  var li = document.createElement('li');\r\n  var paymentMethodID = storedPaymentMethodBool ? \"storedCard\".concat(paymentMethod.id) : paymentMethod.type;\r\n  var isSchemeNotStored = paymentMethod.type === 'scheme' && !storedPaymentMethodBool;\r\n  var paymentMethodImage = storedPaymentMethodBool ? \"\".concat(path).concat(paymentMethod.brand, \".png\") : \"\".concat(path).concat(paymentMethod.type, \".png\");\r\n  var cardImage = \"\".concat(path, \"card.png\");\r\n  var imagePath = isSchemeNotStored ? cardImage : paymentMethodImage;\r\n  var label = storedPaymentMethodBool ? \"\".concat(MASKED_CC_PREFIX).concat(paymentMethod.lastFour) : \"\".concat(paymentMethod.name);\r\n  if (storedPaymentMethodBool) {\r\n    var liContents = \"\\n                              <input name=\\\"brandCode\\\" type=\\\"radio\\\" value=\\\"\".concat(paymentMethodID, \"\\\" id=\\\"rb_\").concat(paymentMethodID, \"\\\">\\n                             <label id=\\\"lb_\").concat(paymentMethodID, \"\\\" for=\\\"rb_\").concat(paymentMethodID, \"\\\">\").concat(label, \"</label>\\n                             \");\r\n    // ECOM-664\r\n    // var liContents = \"\\n <div class='input-label-wrapper'> <div class='input-label-item'><input name=\\\"brandCode\\\" type=\\\"radio\\\" value=\\\"\".concat(paymentMethodID, \"\\\" id=\\\"rb_\").concat(paymentMethodID, \"\\\">\\n <label id=\\\"lb_\").concat(paymentMethodID, \"\\\" for=\\\"rb_\").concat(paymentMethodID, \"\\\">\").concat(label, \"</label>\\n  </div>\");\r\n    // liContents += \"<div class='action-buttons'><i class='fa fa-ellipsis-v card-ellipsis card-icon'></i><i class='fa fa-pencil edit-card card-icon wraped-icon'></i><i class='fa fa-trash-o delete-card card-icons wraped-icon' data-token='\" + paymentMethod.id + \"'></i> </div> </div>\";\r\n  } else {\r\n    var liContents = \"\\n <input class=\\\"adhyenPaymentMethod\\\" name=\\\"brandCode\\\" type=\\\"radio\\\" value=\\\"\".concat(paymentMethodID, \"\\\" id=\\\"rb_\").concat(paymentMethodID, \"\\\">\\n <label class=\\\"adhyenPaymentMethod\\\" id=\\\"lb_\").concat(paymentMethodID, \"\\\" for=\\\"rb_\").concat(paymentMethodID, \"\\\">\").concat(label, \"</label>\\n \");\r\n  }\r\n  if (description) {\r\n    liContents += \"<p>\".concat(description, \"</p>\");\r\n  }\r\n\r\n  var container = document.createElement('div');\r\n\r\n  li.innerHTML = liContents;\r\n  li.classList.add('paymentMethod');\r\n  if (storedPaymentMethodBool) {\r\n    li.classList.add('scheme');\r\n    li.classList.add('stored');\r\n  }\r\n  li.classList.add(paymentMethodID);\r\n\r\n  if (storedPaymentMethodBool) {\r\n    node = checkout.create('card', paymentMethod);\r\n\r\n    if (!componentsObj[paymentMethodID]) {\r\n      componentsObj[paymentMethodID] = {};\r\n    }\r\n\r\n    componentsObj[paymentMethodID].node = node;\r\n    /** adding card number field for saved card */\r\n    var customCardInputContainer = document.createElement('div');\r\n    customCardInputContainer.classList.add('custom-card-input');\r\n\r\n    var cardTypeSpan = document.createElement('span');\r\n    cardTypeSpan.classList.add(paymentMethod.brand);\r\n    cardTypeSpan.classList.add('card');\r\n\r\n    var savedCardNumber = document.createElement('input');\r\n    savedCardNumber.className = 'adyen-checkout__input';\r\n    savedCardNumber.value = \"\".concat(MASKED_CC_PREFIX).concat(paymentMethod.lastFour);\r\n    savedCardNumber.disabled = true;\r\n\r\n    var customCardHolderContainer = document.createElement('div');\r\n    customCardInputContainer.classList.add('custom-card-holder-cont');\r\n    var savedCardName = document.createElement('input');\r\n    savedCardName.className = 'adyen-checkout__input';\r\n    savedCardName.value = paymentMethod.holderName;\r\n    savedCardName.disabled = true;\r\n    customCardHolderContainer.appendChild(savedCardName);\r\n\r\n    customCardInputContainer.appendChild(cardTypeSpan);\r\n    customCardInputContainer.appendChild(savedCardNumber);\r\n    container.appendChild(customCardInputContainer);\r\n    container.appendChild(savedCardName);\r\n  } else {\r\n    var fallback = getFallback(paymentMethod.type);\r\n\r\n    if (fallback) {\r\n      var template = document.createElement('template');\r\n      template.innerHTML = fallback;\r\n      container.appendChild(template.content);\r\n    } else {\r\n      try {\r\n        node = checkout.create(paymentMethod.type);\r\n\r\n        if (!componentsObj[paymentMethodID]) {\r\n          componentsObj[paymentMethodID] = {};\r\n        }\r\n\r\n        componentsObj[paymentMethodID].node = node;\r\n      } catch (e) {} // eslint-disable-line no-empty\r\n\r\n    }\r\n  }\r\n\r\n  container.classList.add('additionalFields');\r\n  container.setAttribute('id', \"component_\".concat(paymentMethodID));\r\n  container.setAttribute('style', 'display:none');\r\n\r\n  li.appendChild(container); \r\n  paymentMethodsUI.appendChild(li);\r\n\r\n  if (paymentMethod.type !== 'paywithgoogle') {\r\n    node && node.mount(container);\r\n  } else {\r\n    node.isAvailable().then(() => {\r\n      node.mount(container);\r\n    }).catch(() => {}); // eslint-disable-line no-empty\r\n  }\r\n\r\n  if (storedPaymentMethodBool) {\r\n    /** adding card number field for saved card */\r\n    var customCardInputContainer = document.createElement('div');\r\n    customCardInputContainer.classList.add('custom-card-input');\r\n\r\n    var cardTypeSpan = document.createElement('span');\r\n    cardTypeSpan.classList.add(paymentMethod.brand);\r\n    cardTypeSpan.classList.add('card');\r\n\r\n    var savedCardNumber = document.createElement('input');\r\n    savedCardNumber.className = 'adyen-checkout__input';\r\n    savedCardNumber.value = \"\".concat(MASKED_CC_PREFIX).concat(paymentMethod.lastFour);\r\n    savedCardNumber.disabled = true;\r\n\r\n    customCardInputContainer.appendChild(cardTypeSpan);\r\n    customCardInputContainer.appendChild(savedCardNumber);\r\n\r\n    var useAnotherCardLink = document.createElement('div');\r\n    useAnotherCardLink.classList.add('cc-link-holder');\r\n    var useAnotherCardLinkSpan = document.createElement('span');\r\n    useAnotherCardLinkSpan.classList.add('another-card');\r\n    useAnotherCardLinkSpan.classList.add('change-card');\r\n    useAnotherCardLinkSpan.innerText = 'Andere Kreditkarte verwenden';\r\n    useAnotherCardLink.appendChild(useAnotherCardLinkSpan);\r\n\r\n    container.appendChild(customCardInputContainer);\r\n    container.appendChild(useAnotherCardLink);\r\n  } else if (paymentMethodID == 'scheme' && $('.data-checkout-stage').data('customer-type') === 'registered' && $('#paymentMethodsList').find('li.stored').length > 0) {\r\n    var useSavedCardLink = document.createElement('div');\r\n    useSavedCardLink.classList.add('cc-link-holder');\r\n    var useSavedCardLinkSpan = document.createElement('span');\r\n    useSavedCardLinkSpan.classList.add('saved-card');\r\n    useSavedCardLinkSpan.classList.add('change-card');\r\n    useSavedCardLinkSpan.innerText = 'Gespeicherte Kreditkarte verwenden';\r\n    useSavedCardLink.appendChild(useSavedCardLinkSpan);\r\n    container.appendChild(useSavedCardLink);\r\n  }\r\n\r\n  var input = document.querySelector(\"#rb_\".concat(paymentMethodID));\r\n\r\n  input.onchange = event => {\r\n    displaySelectedMethod(event.target.value);\r\n  };\r\n\r\n  if (componentsObj[paymentMethodID] && !container.childNodes[0]) {\r\n    componentsObj[paymentMethodID].isValid = true;\r\n  }\r\n} // eslint-disable-next-line no-unused-vars\r\n\r\n\r\nfunction addPosTerminals(terminals) {\r\n  var terminalSelect = document.createElement('select');\r\n  terminalSelect.id = 'terminalList';\r\n\r\n  for (var t in terminals) {\r\n    var option = document.createElement('option');\r\n    option.value = terminals[t];\r\n    option.text = terminals[t];\r\n    terminalSelect.appendChild(option);\r\n  }\r\n\r\n  document.querySelector('#adyenPosTerminals').append(terminalSelect);\r\n}\r\n\r\nfunction resetPaymentMethod() {\r\n  $('#requiredBrandCode').hide();\r\n  $('#selectedIssuer').val('');\r\n  $('#adyenIssuerName').val('');\r\n  $('#dateOfBirth').val('');\r\n  $('#telephoneNumber').val('');\r\n  $('#gender').val('');\r\n  $('#bankAccountOwnerName').val('');\r\n  $('#bankAccountNumber').val('');\r\n  $('#bankLocationId').val('');\r\n  $('.additionalFields').hide();\r\n}\r\n/**\r\n * Makes an ajax call to the controller function GetPaymentMethods\r\n */\r\n\r\n function setLimitsRatepay() {\r\n  if ((($('.nav-link.adyen-tab.active').text().indexOf('Rechnung') > -1) || $('.nav-link.adyen-tab.active').text().indexOf('invoice') > -1) && (!$('li.placeOrder').hasClass('active'))) {\r\n  var errorMsg2;\r\n  var minValue = $('#minValueCheckout').attr('value');\r\n  var maxValue = $('#maxValueCheckout').attr('value');\r\n    if (minValue || maxValue) {\r\n      var totalSum = $('.grand-total-sum').text();\r\n      var check = totalSum.substr(totalSum.length - 3);\r\n      if (check.indexOf(\".\") >= 0) {\r\n        var sd = totalSum.replace(/[^0-9.]/gi, '');\r\n        var total = parseInt(sd);\r\n      } else {\r\n        var newString = totalSum.replace('.','').replace(',','.');\r\n        var sd = newString.replace(/[^0-9.]/gi, '');\r\n        var total = parseInt(sd);\r\n      }\r\n      \r\n      if (total < minValue) {\r\n        errorMsg2 = $('#minValueCheckout').data('error-min');\r\n        $(\"#dateOfBirthInput\").hide();\r\n        $('button[value=\"submit-payment\"]').hide();\r\n        $('div.ratepay-info').hide();\r\n        $('#dobError').hide();\r\n        $('span.adyen-checkout__label').hide();\r\n      } else if (total > maxValue) {\r\n        errorMsg2 = $('#maxValueCheckout').data('error-max');\r\n        $(\"#dateOfBirthInput\").hide();\r\n        $('button[value=\"submit-payment\"]').hide();\r\n        $('div.ratepay-info').hide();\r\n        $('#dobError').hide();\r\n        $('span.adyen-checkout__label').hide();\r\n      }\r\n    }\r\n    if (errorMsg2) {\r\n      $(\"#dateOfBirthInput\").after('<div id=\\'limitError\\'> <div class=\\\"ratepay-info-content\\\"><div class=\\\"ratepay-content-wrapper\\\"><div class=\\\"icon-holder\\\"><svg fill=\"none\" viewBox=\"0 0 18 18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m9.9 6.3h-1.8v-1.8h1.8v1.8zm0 7.2h-1.8v-5.4h1.8v5.4zm-0.891 4.5c4.968 0 8.991-4.032 8.991-9s-4.023-9-8.991-9c-4.977-4.351e-7 -9.009 4.032-9.009 9-4.3431e-7 4.968 4.032 9 9.009 9zm-9e-3 -16.2c3.978 0 7.2 3.222 7.2 7.2s-3.222 7.2-7.2 7.2-7.2-3.222-7.2-7.2 3.222-7.2 7.2-7.2z\" fill=\"#000\"></path></svg></div><span class=\\\"info-message\\\">' + errorMsg2 + '</span></div></div></div>');\r\n    }\r\n    else {\r\n      $(\"#dateOfBirthInput\").show();\r\n      $('#limitError').remove();\r\n      if ($('li.payment').hasClass('active')) {\r\n        $('button[value=\"submit-payment\"]').show();\r\n    } else {\r\n        $('button[value=\"submit-payment\"]').hide();\r\n    }\r\n    }\r\n  } else {\r\n    if ($('li.payment').hasClass('active')) {\r\n      $('button[value=\"submit-payment\"]').show();\r\n  } else {\r\n      $('button[value=\"submit-payment\"]').hide();\r\n  }\r\n    $('#limitError').remove();\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction getPaymentMethods(paymentMethods) {\r\n  var getPaymentMethodsURL = $('#checkout-main').data('adyen-getpaymentmethods-url');\r\n  $('#checkout-main').spinner().start();\r\n  $.ajax({\r\n    url: getPaymentMethodsURL,\r\n    type: 'get',\r\n    success: function success(data) {\r\n      paymentMethods(data);\r\n      $('#checkout-main').spinner().stop();\r\n      setLimitsRatepay();\r\n    }\r\n  });\r\n}\r\n/**\r\n * Makes an ajax call to the controller function PaymentFromComponent. Used by certain payment methods like paypal\r\n */\r\n\r\n\r\nfunction paymentFromComponent(data, component) {\r\n  $.ajax({\r\n    url: 'Adyen-PaymentFromComponent',\r\n    type: 'post',\r\n    data: {\r\n      data: JSON.stringify(data),\r\n      paymentMethod: document.querySelector('#adyenPaymentMethodName').value\r\n    },\r\n    success: function success(data) {\r\n      if (data.fullResponse && data.fullResponse.action) {\r\n        component.handleAction(data.fullResponse.action);\r\n      } else {\r\n        document.querySelector('#showConfirmationForm').submit();\r\n      }\r\n    }\r\n  }).fail(function () {});\r\n} // Submit the payment\r\n\r\n\r\n$('.paypal-tab').on('click', function () {\r\n  $('button[value=\"submit-payment\"]').show();\r\n});\r\n\r\n$('button[value=\"submit-payment\"]').on('click', function () {\r\n  if ($('#component_ratepay').length > 0 && $('#component_ratepay:hidden').length === 0) {\r\n    var dob = $('#dateOfBirthInput').val();\r\n    var pattern = /^(0[1-9]|[12][0-9]|3[01])\\.(0[1-9]|1[012])\\.\\d{4}$/g;\r\n    var errorMsg;\r\n    \r\n    if (!dob) {\r\n        errorMsg = $('.ratepay-tab').data('dob-missing-error');\r\n    } else if (isCurrentDate() === true) {\r\n      errorMsg = $('.ratepay-tab').data('dob-todays-date-error');\r\n    } else if (!pattern.test(dob)) {\r\n        var errorMsg = $('.ratepay-tab').data('ratepay-dob-error');\r\n    } else if (isValidDob() === false) {\r\n      errorMsg = $('.ratepay-tab').data('ratepay-eligibility-error');\r\n    } else {\r\n      $('#dateOfBirthInput').removeClass('adyen-checkout__input--error');\r\n      $('#component_ratepay .adyen-checkout__error-text').remove();\r\n    }\r\n    if (errorMsg ) {\r\n      $('#dateOfBirthInput').addClass('adyen-checkout__input--error');\r\n      if ($('#component_ratepay').find('.adyen-checkout__error-text').length === 0) {\r\n        if (errorMsg){\r\n          $(\"#dateOfBirthInput\").after('<span id=\\'dobError\\' class=\\'adyen-checkout__error-text\\'>'+ errorMsg +'</span>');\r\n        }\r\n      } else {\r\n        if (errorMsg){\r\n          if ($('#component_ratepay').find('#dobError').length === 0) {\r\n            $(\"#dateOfBirthInput\").after('<span id=\\'dobError\\' class=\\'adyen-checkout__error-text\\'>'+ errorMsg +'</span>');\r\n          } else {\r\n            $('#component_ratepay').find('#dobError').text(errorMsg);\r\n          }\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  if ($('input[name$=isPaypal]').val() === 'true') {\r\n    return;\r\n  }\r\n  $('.payment-form-fields input').removeAttr('disabled');\r\n  assignPaymentMethodValue();\r\n  validateComponents();\r\n  return showValidation();\r\n});\r\n\r\n//Check Date of Birth for Ratepay greator than 18 or not\r\nfunction isValidDob() {\r\n  var dob = $('#dateOfBirthInput').val().split('.');\r\n  var year = dob[2];\r\n  var month = dob[1];\r\n  var day = dob[0];\r\n\r\n  var setDate = new Date(parseInt(year) + 18, month - 1, day);\r\n  var currdate = new Date();\r\n  if(currdate >= setDate) {\r\n    return true;\r\n  }\r\n  else {\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\n//Check Date of Birth for Ratepay is current Date\r\nfunction isCurrentDate() {\r\n  var dob = $('#dateOfBirthInput').val().split('.');\r\n  var year = dob[2];\r\n  var month = dob[1];\r\n  var day = dob[0];\r\n\r\n  var setDate = new Date(year, month - 1, day);\r\n  var currdate = new Date();\r\n  currdate.setHours(0, 0, 0, 0);\r\n  setDate.setHours(0, 0, 0, 0);\r\n  if(currdate.toDateString() == setDate.toDateString()) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction assignPaymentMethodValue() {\r\n  var adyenPaymentMethod = document.querySelector('#adyenPaymentMethodName');\r\n  adyenPaymentMethod.value = document.querySelector(\"#lb_\".concat(selectedMethod)).innerText;\r\n}\r\n\r\nfunction showValidation() {\r\n  var input;\r\n\r\n  if (componentsObj[selectedMethod] && !componentsObj[selectedMethod].isValid) {\r\n    componentsObj[selectedMethod].node.showValidation();\r\n    return false;\r\n  }\r\n\r\n  if (selectedMethod === 'ach') {\r\n    var inputs = document.querySelectorAll('#component_ach > input');\r\n    inputs = Object.values(inputs).filter(function (input) {\r\n      return !(input.value && input.value.length > 0);\r\n    });\r\n\r\n    for (input of inputs) {\r\n      input.classList.add('adyen-checkout__input--error');\r\n    }\r\n\r\n    if (inputs.length > 0) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  if (selectedMethod === 'ratepay') {\r\n    var inputs = document.querySelectorAll('#component_ratepay > input');\r\n    inputs = Object.values(inputs).filter(function (input) {\r\n      return !(input.value && input.value.length > 0);\r\n    });\r\n\r\n    for (input of inputs) {\r\n      input.classList.add('adyen-checkout__input--error');\r\n    }\r\n\r\n    if (inputs.length > 0) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction validateCustomInputField(input) {\r\n  if (input.value === '') {\r\n    input.classList.add('adyen-checkout__input--error');\r\n  } else if (input.value.length > 0) {\r\n    input.classList.remove('adyen-checkout__input--error');\r\n  }\r\n}\r\n/**\r\n * Assigns stateData value to the hidden stateData input field so it's sent to the backend for processing\r\n */\r\n\r\n\r\nfunction validateComponents() {\r\n  if (document.querySelector('#component_ach')) {\r\n    var inputs = document.querySelectorAll('#component_ach > input');\r\n\r\n    for (var input of inputs) {\r\n      input.onchange = function () {\r\n        validateCustomInputField(this);\r\n      };\r\n    }\r\n  }\r\n\r\n  if (document.querySelector('#dateOfBirthInput')) {\r\n    document.querySelector('#dateOfBirthInput').onchange = function () {\r\n      validateCustomInputField(this);\r\n    };\r\n  }\r\n\r\n  var stateData;\r\n\r\n  if (componentsObj[selectedMethod] && componentsObj[selectedMethod].stateData) {\r\n    stateData = componentsObj[selectedMethod].stateData;\r\n  } else {\r\n    stateData = {\r\n      paymentMethod: {\r\n        type: selectedMethod\r\n      }\r\n    };\r\n  }\r\n\r\n  if (selectedMethod === 'ach') {\r\n    var bankAccount = {\r\n      ownerName: document.querySelector('#bankAccountOwnerNameValue').value,\r\n      bankAccountNumber: document.querySelector('#bankAccountNumberValue').value,\r\n      bankLocationId: document.querySelector('#bankLocationIdValue').value\r\n    };\r\n    stateData.paymentMethod = _objectSpread(_objectSpread({}, stateData.paymentMethod), {}, {\r\n      bankAccount: bankAccount\r\n    });\r\n  } else if (selectedMethod === 'ratepay') {\r\n    if (document.querySelector('#dateOfBirthInput').value) {\r\n      // As format is different on front end\r\n      var adyenFormatDate =  document.querySelector('#dateOfBirthInput').value.split('.');\r\n      stateData.dateOfBirth = adyenFormatDate[2]+'-'+adyenFormatDate[1]+'-'+adyenFormatDate[0];\r\n    }\r\n  }\r\n\r\n  document.querySelector('#adyenStateData').value = JSON.stringify(stateData);\r\n}\r\n/**\r\n * Contains fallback components for payment methods that don't have an Adyen web component yet\r\n */\r\n\r\nfunction getFallback(paymentMethod) {\r\n  var dateOfBirth = document.querySelector('#dateOfBirth').value.split('-');\r\n  var ach = \"<div id=\\\"component_ach\\\">\\n                    <span class=\\\"adyen-checkout__label\\\">Bank Account Owner Name</span>\\n                    <input type=\\\"text\\\" id=\\\"bankAccountOwnerNameValue\\\" class=\\\"adyen-checkout__input\\\">\\n                    <span class=\\\"adyen-checkout__label\\\">Bank Account Number</span>\\n                    <input type=\\\"text\\\" id=\\\"bankAccountNumberValue\\\" class=\\\"adyen-checkout__input\\\" maxlength=\\\"17\\\" >\\n                    <span class=\\\"adyen-checkout__label\\\">Routing Number</span>\\n                    <input type=\\\"text\\\" id=\\\"bankLocationIdValue\\\" class=\\\"adyen-checkout__input\\\" maxlength=\\\"9\\\" >\\n                 </div>\";\r\n  var ratepay = \"<span class=\\\"adyen-checkout__label\\\">Geburtsdatum</span>\\n                    <input id=\\\"dateOfBirthInput\\\" class=\\\"adyen-checkout__input\\\" inputmode=\\\"numeric\\\"  placeholder=\\\"TT.MM.JJJJ*\\\" type=\\\"text\\\" value=\\\"\" + dateOfBirth[2]+'.'+dateOfBirth[1]+'.'+dateOfBirth[0] +\"\\\"/> <div class=\\\"ratepay-info\\\">\";\r\n  ratepay += $('.ratepay-tab').data('ratepay-msg') + \"</div>\";\r\n  var fallback = {\r\n    ach: ach,\r\n    ratepay: ratepay\r\n  };\r\n  return fallback[paymentMethod];\r\n}\r\n\r\nmodule.exports = {\r\n  methods: {\r\n    renderGenericComponent: renderGenericComponent\r\n  }\r\n};\r\n\r\n\n\n//# sourceURL=webpack:///./cartridges/kickstarterpackage/cartridge/client/default/js/adyenCheckout.js?");

/***/ })

/******/ });